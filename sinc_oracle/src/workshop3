SELECT * FROM TB_STUDENT;


--1
SELECT	STUDENT_NAME, STUDENT_ADDRESS
FROM	TB_STUDENT
ORDER BY STUDENT_NAME;

--2
SELECT	STUDENT_NAME, STUDENT_SSN
FROM	TB_STUDENT
WHERE	ABSENCE_YN = 'Y'
ORDER BY	STUDENT_SSN DESC;

--3
SELECT	STUDENT_NAME AS 학생이름,
		STUDENT_NO AS 학번,
		STUDENT_ADDRESS AS "거주지 주소"
FROM	TB_STUDENT
WHERE	STUDENT_NO NOT LIKE 'A%'
AND		(STUDENT_ADDRESS LIKE '경기도%' OR STUDENT_ADDRESS LIKE '강원도%');

SELECT * FROM TB_DEPARTMENT;
SELECT * FROM TB_PROFESSOR;
SELECT * FROM TB_STUDENT;
SELECT * FROM TB_CLASS;
--4
SELECT	PROFESSOR_NAME,
		PROFESSOR_SSN
FROM	TB_PROFESSOR
WHERE	DEPARTMENT_NO = 005
ORDER BY	PROFESSOR_SSN;

SELECT * FROM TB_GRADE;

--5*************
SELECT	STUDENT_NO,
		POINT
FROM	TB_GRADE
WHERE	TERM_NO = '200402'
AND		CLASS_NO = 'C3118100'
ORDER BY	POINT DESC, STUDENT_NO ASC;

--6
SELECT	STUDENT_NO,
		STUDENT_NAME,
		D.DEPARTMENT_NAME
FROM	TB_STUDENT T
JOIN	TB_DEPARTMENT D USING (DEPARTMENT_NO) -- USING 내부에서는 테이블 별칭을 사용할 수 없다
ORDER BY	STUDENT_NAME;

--7
SELECT	CLASS_NAME,
		D.DEPARTMENT_NAME
FROM	TB_CLASS C
JOIN	TB_DEPARTMENT D USING (DEPARTMENT_NO)
ORDER BY D.DEPARTMENT_NAME;

--8
SELECT	C.CLASS_NAME,
		P.PROFESSOR_NAME
FROM	TB_CLASS C
JOIN	TB_CLASS_PROFESSOR CP USING (CLASS_NO)
JOIN	TB_PROFESSOR P ON (CP.PROFESSOR_NO = P.PROFESSOR_NO)
ORDER BY 1;

--9 여러 칼럼명이 생기며 USING 보단 ON을 사용해서 명확하게 처리할 것
--FROM절에 8번 넣어서 뷰를 만들고 조인해보기
SELECT	C.CLASS_NAME,
		P.PROFESSOR_NAME
FROM	TB_CLASS C
JOIN	TB_CLASS_PROFESSOR CP ON (C.CLASS_NO = CP.CLASS_NO)
JOIN	TB_PROFESSOR P ON (CP.PROFESSOR_NO = P.PROFESSOR_NO)
JOIN	TB_DEPARTMENT D ON (D.DEPARTMENT_NO = C.DEPARTMENT_NO)
WHERE	D.CATEGORY = '인문사회';

--10
SELECT	S.STUDENT_NO,
		S.STUDENT_NAME,
		ROUND(AVG(G.POINT), 1)
FROM	TB_GRADE G
JOIN	TB_STUDENT S ON (G.STUDENT_NO = S.STUDENT_NO)
WHERE	S.DEPARTMENT_NO = '059'
GROUP BY S.STUDENT_NO, S.STUDENT_NAME;

SELECT	S.STUDENT_NO,
		S.STUDENT_NAME,
		ROUND(AVG(G.POINT), 1)
FROM	TB_GRADE G
JOIN	TB_STUDENT S ON (G.STUDENT_NO = S.STUDENT_NO)
WHERE	S.DEPARTMENT_NO = ( SELECT	DEPARTMENT_NO
							FROM	TB_DEPARTMENT
							WHERE 	DEPARTMENT_NAME = '음악학과')
GROUP BY S.STUDENT_NO, S.STUDENT_NAME;

--11
SELECT	D.DEPARTMENT_NAME
	,	S.STUDENT_NAME
	,	P.PROFESSOR_NAME
FROM	TB_STUDENT S
JOIN	TB_DEPARTMENT D ON (D.DEPARTMENT_NO = S.DEPARTMENT_NO)
JOIN	TB_PROFESSOR P ON (S.COACH_PROFESSOR_NO = P.PROFESSOR_NO)
WHERE	S.STUDENT_NO = 'A313047';

--12
SELECT	S.STUDENT_NAME
	,	G.TERM_NO
FROM	TB_GRADE G
JOIN	TB_CLASS C ON (C.CLASS_NO = G.CLASS_NO)
JOIN	TB_STUDENT S ON (S.STUDENT_NO = G.STUDENT_NO)
WHERE	G.TERM_NO LIKE '2007%'
AND		C.CLASS_NAME = '인간관계론';

--13
SELECT	C.CLASS_NAME
	,	D.DEPARTMENT_NAME
FROM	TB_CLASS C
JOIN	TB_DEPARTMENT D ON (C.DEPARTMENT_NO = D.DEPARTMENT_NO)
LEFT JOIN	TB_CLASS_PROFESSOR CP ON (C.CLASS_NO = CP.CLASS_NO)
WHERE	D.CATEGORY = '예체능' 
AND		PROFESSOR_NO IS NULL;

--14
SELECT	S.STUDENT_NAME AS 학생이름
	,	NVL(P.PROFESSOR_NAME,'지도교수없음') AS 지도교수
FROM	TB_STUDENT S
LEFT OUTER JOIN TB_PROFESSOR P ON (S.COACH_PROFESSOR_NO = P.PROFESSOR_NO)
WHERE	S.DEPARTMENT_NO = (  SELECT DEPARTMENT_NO
							FROM	TB_DEPARTMENT
							WHERE	DEPARTMENT_NAME = '서반아어학과');		
								
--15
SELECT	STUDENT_NO
	,	STUDENT_NAME
	,	DEPARTMENT_NAME
	,	AVG(POINT)
FROM	TB_STUDENT
JOIN	TB_DEPARTMENT USING (DEPARTMENT_NO)
JOIN	TB_GRADE USING (STUDENT_NO)
WHERE	ABSENCE_YN = 'N'
GROUP BY	STUDENT_NO, STUDENT_NAME, DEPARTMENT_NAME
HAVING	AVG(POINT) >= '4';
--16
SELECT	C.CLASS_NO
	,	C.CLASS_NAME
	,	AVG(G.POINT)
FROM	TB_CLASS C
JOIN	TB_GRADE G ON (C.CLASS_NO = G.CLASS_NO)
WHERE	C.DEPARTMENT_NO = ( SELECT DEPARTMENT_NO
							FROM	TB_DEPARTMENT
							WHERE	DEPARTMENT_NAME = '환경조경학과')
AND		C.CLASS_TYPE LIKE '전공%'
GROUP BY C.CLASS_NO, C.CLASS_NAME;

--17
SELECT	STUDENT_NAME
	,	STUDENT_ADDRESS
FROM	TB_STUDENT
WHERE	DEPARTMENT_NO = ( SELECT	DEPARTMENT_NO
							FROM	TB_STUDENT
							WHERE	STUDENT_NAME = '최경희')

--18
SELECT	S.STUDENT_NO
	,	S.STUDENT_NAME
FROM	TB_STUDENT S
JOIN	TB_GRADE G ON (S.STUDENT_NO = G.STUDENT_NO)		
WHERE	S.DEPARTMENT_NO = '001'
GROUP BY S.STUDENT_NO, S.STUDENT_NAME
HAVING	AVG(G.POINT) = ( 	SELECT	MAX(AVG(POINT))
							FROM	TB_GRADE GG
							JOIN	TB_CLASS C ON (C.CLASS_NO = GG.CLASS_NO)
							WHERE	C.DEPARTMENT_NO	= '001'
							GROUP BY STUDENT_NO) ;

--19
SELECT	D.DEPARTMENT_NAME AS 학과명
	,	ROUND(AVG(G.POINT), 1) AS 전공평점
FROM	TB_GRADE G
JOIN	TB_CLASS C ON (G.CLASS_NO = G.CLASS_NO)
JOIN	TB_DEPARTMENT D ON (C.DEPARTMENT_NO = D.DEPARTMENT_NO AND D.CATEGORY = '자연과학')
GROUP BY D.DEPARTMENT_NAME;

















